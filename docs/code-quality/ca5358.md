---
title: "CA5358: Do Not Use Unsafe Cipher Modes"
description: Provides information about code analysis rule CA5358, including causes, how to fix violations, and when to suppress it.
ms.date: 01/07/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
manager: jillfra
dev_langs:
 - CSharp
ms.workload:
  - "multiple"
f1_keywords:
  - "CA5358"
---
# CA5358: Do Not Use Unsafe Cipher Modes

|||
|-|-|
|TypeName|ApprovedCipherModeAnalyzer|
|CheckId|CA5358|
|Category|Microsoft.Security|
|Breaking change|Non-breaking|

## Cause

Use of one of the following unsafe encryption modes that is not approved:

- <xref:System.Security.Cryptography.CipherMode.ECB?displayProperty=fullName>
- <xref:System.Security.Cryptography.CipherMode.OFB?displayProperty=fullName>
- <xref:System.Security.Cryptography.CipherMode.CFB?displayProperty=fullName>

## Rule description

These modes are vulnerable to attacks and may cause exposure of sensitive information. For example, using `ECB` to encrypt a plaintext block always produces a same cipher text, so it can easily tell if two encrypted messages are identical. Using approved modes can avoid these unnecessary risks.

## How to fix violations

- Use only approved modes (<xref:System.Security.Cryptography.CipherMode.CBC?displayProperty=fullName>, <xref:System.Security.Cryptography.CipherMode.CTS?displayProperty=fullName>).

## When to suppress warnings

OFB and CFB may be acceptable modes if you well understand your requirements.

## Pseudo-code examples

### Assign ECB to Mode property

```csharp
using System.Security.Cryptography;

class ExampleClass {
    private static void ExampleMethod () {
        RijndaelManaged rijn = new RijndaelManaged
        {
            Mode = CipherMode.ECB
        };
    }
}
```

### Using the value ECB

```csharp
using System;
using System.Security.Cryptography;

class ExampleClass
{
    private static void ExampleMethod()
    {
        Console.WriteLine(CipherMode.ECB);
    }
}
```

### Solution

```csharp
using System.Security.Cryptography;

class ExampleClass {
    private static void ExampleMethod () {
        RijndaelManaged rijn = new RijndaelManaged
        {
            Mode = CipherMode.CBC
        };
    }
}
```
