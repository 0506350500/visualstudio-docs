---
title: "CA5375: Do not use account shared access signature"
description: Provides information about code analysis rule CA5375, including causes, how to fix violations, and when to suppress it.
ms.date: 05/19/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
manager: jillfra
ms.workload:
  - "multiple"
f1_keywords:
  - "CA5375"
  - "DoNotUseAccountSAS"
---
# CA5375: Do not use account shared access signature

|||
|-|-|
|CheckId|CA5375|
|Category|Microsoft.Security|
|Breaking change|Non-breaking|

## Cause

Generate an account Shared Access Signature (SAS) with <xref:Microsoft.WindowsAzure.Storage.GetSharedAccessSignature%2A?displayProperty=fullName>.

## Rule description

An account SAS can delegate access to read, write, and delete operations on blob containers, tables, queues, and file shares that are not permitted with a service SAS. However, it can't refer container-level policy and has less flexibility and control over the permissions that are granted. Once malicious uses get it, your storage account will be compromised easily.

## How to fix violations

Use Service SAS instead of Account SAS for fine grained access control and container-level access policy.

## When to suppress warnings

It is safe to suppress this rule if you're sure that the permissions of all resources are granted properly and the account SAS is stored in a safe place, like Azure key vault.

## Pseudo-code examples

### Violation

At present, the following pseudo-code sample illustrates the pattern detected by this rule.

```csharp
using System;
using Microsoft.WindowsAzure.Storage;

class ExampleClass
{
    public void ExampleMethod(SharedAccessAccountPolicy policy)
    {
        CloudStorageAccount cloudStorageAccount = new CloudStorageAccount();
        cloudStorageAccount.GetSharedAccessSignature(policy);
    }
}
```

### Solution

Instead of account SAS, use service SAS.

```csharp
using System;
using Microsoft.WindowsAzure.Storage;
using Microsoft.WindowsAzure.Storage.File;

class ExampleClass
{
    public void ExampleMethod(StorageCredentials storageCredentials, SharedAccessFilePolicy policy, SharedAccessFileHeaders headers, string groupPolicyIdentifier, IPAddressOrRange ipAddressOrRange)
    {
        CloudFile cloudFile = new CloudFile(storageCredentials);
        SharedAccessProtocol protocols = SharedAccessProtocol.HttpsOnly;
        cloudFile.GetSharedAccessSignature(policy, headers, groupPolicyIdentifier, protocols, ipAddressOrRange); 
    }
}
```

## Related rules

[CA5376: Use SharedAccessProtocol HttpsOnly](ca5376.md)

[CA5377: Use container level access policy](ca5377.md)
