---
title: "CA5364: Do Not Use Deprecated Security Protocols"
ms.date: 07/10/2019
ms.topic: reference
author: dotpaul
ms.author: paulming
manager: jillfra
dev_langs:
 - CSharp
 - VB
ms.workload:
  - "multiple"
f1_keywords:
  - "CA5364"
  - "DoNotUseDeprecatedSecurityProtocols"
---
# CA5364: Do Not Use Deprecated Security Protocols

|||
|-|-|
|TypeName|DoNotUseDeprecatedSecurityProtocols|
|CheckId|CA5364|
|Category|Microsoft.Security|
|Breaking Change|Non Breaking|

## Cause

- A deprecated <xref:System.Net.SecurityProtocolType?displayProperty=nameWithType> value was referenced.
- An integer value representing a deprecated value was assigned to a <xref:System.Net.SecurityProtocolType> variable.

Deprecated values are:
- Ssl3
- Tls
- Tls10
- Tls11

## Rule description

Transport Layer Security (TLS) secures communication between computers, most commonly with Hypertext Transfer Protocol Secure (HTTPS). Older protocol versions of TLS are less secure than TLS 1.2 and TLS 1.3, and are more at risk of vulnerabilities being discovered in the future. You should avoid older protocol versions to minimize risk. For guidance on identifying and removing deprecated protocol versions, see [Solving the TLS 1.0 Problem, 2nd Edition](/security/solving-tls1-problem).

## How to fix violations

Don't use deprecated TLS protocol versions.

## When to suppress warnings

- It's safe to suppress this warning if the reference to the deprecated protocol version isn't being used to enable a deprecated version.
- You can suppress this warning if you need to connect to a legacy service, which can't be upgraded to use secure TLS configurations.

## Pseudo-code examples

### Violation

```csharp
using System;
using System.Net;

public class ExampleClass
{
    public void ExampleMethod()
    {
        // CA5364 violation
        ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls11 | SecurityProtocolType.Tls12;
    }
}
```

```vb
Imports System
Imports System.Net

Public Class TestClass
    Public Sub ExampleMethod()
        ' CA5364 violation
        ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls11 Or SecurityProtocolType.Tls12
    End Sub
End Class
```

### Solution

```csharp
using System;
using System.Net;

public class TestClass
{
    public void TestMethod()
    {
        // Let the operating system decide what TLS protocol version to use.
        // See https://docs.microsoft.com/dotnet/framework/network-programming/tls
    }
}
```

```vb
Imports System
Imports System.Net

Public Class TestClass
    Public Sub ExampleMethod()
        ' Let the operating system decide what TLS protocol version to use.
        ' See https://docs.microsoft.com/dotnet/framework/network-programming/tls
    End Sub
End Class
```

## Related rules

[CA5386: Avoid hardcoding SecurityProtocolType value](ca5386.md)