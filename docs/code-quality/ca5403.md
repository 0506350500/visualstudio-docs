---
title: "CA5403: Do not hard-code certificate"
description: Provides information about code analysis rule CA5403, including causes, how to fix violations, and when to suppress it.
ms.date: 10/16/2019
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
manager: dsie
dev_langs:
 - CSharp
ms.workload:
  - "multiple"
f1_keywords:
  - "CA5403"
---
# CA5403: Do not hard-code certificate

|||
|-|-|
|TypeName|DoNotHardCodeCertificate|
|CheckId|CA5403|
|Category|Microsoft.Security|
|Breaking change|Non-breaking|

## Cause

The data or rawData parameter of X509Certificate is hard-coded by:
- Byte array.
- Char array.
- System.Convert.FromBase64String(string s).
- All the overload of System.Text.Encoding.GetBytes().

## Rule description

Hard-coded certificates in source code are vulnerable to being exploited.

## How to fix violations

Instead of using constructors which hard-code data directly, choose the other constructors, like X509Certificate(String), which uses the name of a PKCS7 signed file.

## When to suppress warnings

This rule should not be suppressed.

## Pseudo-code examples

### Hard-coded by byte array.

```csharp
using System.IO;
using System.Security.Cryptography.X509Certificates;

class ExampleClass
{
    public void ExampleMethod(string path)
    {
        byte[] bytes = new byte[] {1, 2, 3};
        File.WriteAllBytes(path, bytes);
        new X509Certificate(path);
    }
}
```

### Hard-coded by char array.

```csharp
using System.IO;
using System.Security.Cryptography.X509Certificates;

class ExampleClass
{
    public void ExampleMethod(string path)
    {
        char[] chars = new char[] {'1', '2', '3'};
        new ASCIIEncoding().GetBytes(chars, 0, 3, bytes, 0);
        File.WriteAllBytes(path, bytes);
        new X509Certificate(path);
    }
}
```

### Hard-coded by FromBase64String.

```csharp
using System;
using System.IO;
using System.Security.Cryptography.X509Certificates;

class ExampleClass
{
    public void ExampleMethod(string path)
    {
        byte[] bytes = Convert.FromBase64String("AAAAAaazaoensuth");
        File.WriteAllBytes(path, bytes);
        new X509Certificate(path);
    }
}
```

### Hard-coded by GetBytes.

```csharp
using System;
using System.IO;
using System.Security.Cryptography.X509Certificates;

class ExampleClass
{
    public void ExampleMethod(string path)
    {
        byte[] bytes = new ASCIIEncoding().GetBytes("AAAAAaazaoensuth");
        File.WriteAllBytes(path, bytes);
        new X509Certificate(path);
    }
}
```

### Solution

```csharp
using System.IO;
using System.Security.Cryptography.X509Certificates;

class ExampleClass
{
    public void ExampleMethod(string path)
    {
        new X509Certificate("Certificate.cer");
    }
}
```

## Related rules

[CA5390: Do not hard-code encryption key](ca5390.md)
