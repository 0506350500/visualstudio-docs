---
title: "CA5369: Use XmlReader For Deserialize"
description: Provides information about code analysis rule CA5369, including causes, how to fix violations, and when to suppress it.
ms.date: 08/14/2019
ms.topic: reference
author: EvaSchmotzerova
ms.author: filipse
manager: jillfra
dev_langs:
 - CSharp
ms.workload:
  - "multiple"
f1_keywords:
  - "CA5369"
  - "UseXMLReaderForDeserialize"
---
# CA5369: Use XmlReader For Deserialize

|||
|-|-|
|TypeName|UseXMLReaderForDeserialize|
|CheckId|CA5369|
|Category|Microsoft.Security|
|Breaking Change|Non Breaking|

## Cause

Deserializing untrusted XML input with <xref:system.xml.serialization.xmlserializer.deserialize?displayProperty=nameWithType> instantiated without an `XmlReader` object can potentially lead to denial of service, information disclosure and server-side request forgery attacks. These attacks are enabled by untrusted DTD and XML schema processing allowing for the inclusion of XML bombs and malicious external entities in the XML. Only with `XmlReader` it is possible to disable DTD and inline XML schema processing as `XmlReader` has the `ProhibitDtd` and `ProcessInlineSchema` property set to `false` by default in .NET Framework >=4.0. The other options such as `Stream`, `TextReader` and `XmlSerializationReader` cannot disable DTD processing.

## Rule description

Processing untrusted DTD and XML schemas may enable loading dangerous external references, which should be restricted by using an `XmlReader` with a secure resolver or with DTD and XML inline schema processing disabled. This rule detects code that uses <xref:system.xml.serialization.xmlserializer.deserialize%2A?displayProperty=nameWithType> method and does not take `XmlReader` as a constructor parameter.

## How to fix violations

Do not use <xref:system.xml.serialization.xmlserializer.deserialize?displayProperty=nameWithType> overloads other than `XmlSerializer.Deserialize(XmlReader, *)`

## When to suppress warnings

You can potentially suppress this warning if the parsed XML comes from a trusted source and hence cannot be tampered with.

## Pseudo-code examples

### Violation

As of the time of this writing, the following pseudo-code sample illustrates the pattern detected by this rule.
The type of the first parameter of <xref:system.xml.serialization.xmlserializer.deserialize?displayProperty=nameWithType> is not XmlReader or it is a derived class.

```csharp
using System.IO;
using System.Xml.Serialization;
...
new XmlSerializer(typeof(TestClass).Deserialize(new FileStream("filename", FileMode.Open));
```

### Solution

```csharp
using System.IO;
using System.Xml;
using System.Xml.Serialization;
...
new XmlSerializer(typeof(TestClass).Deserialize(XmlReader.Create (new FileStream("filename", FileMode.Open)));
```